---
layout: post
title:  "各消息队列对比"
date:   2020-10-08 09:58:06 +0800--
categories: [Java, 分布式]
tags: [Java, 消息队列]  
---

# 单机吞吐量

ActiveMQ：万级，吞吐量比RocketMQ和Kafka要低一个数量级。
RabbitMQ：万级，吞吐量比RocketMQ和Kafka要低一个数量级。
RocketMQ:10万级，RocketMQ也是可以支撑高吞吐的一种MQ。
Kafka:10万级，这是Kafka最大的优点，就是吞吐量高；一般配合大数据类的系统来进行实时数据基数按、日志采集等场景。

# Topic数量对吞吐量的影响

RocketMQ:topic可以达到几百，几千个的级别，吞吐量会有较小幅度的下降；这是RocketMQ的一大优势，在同等机器下，可以支撑大量的topic。
Kafka:topic从几十个到几百个的时候，吞吐量会大幅度下降所以在同等机器下，kafka尽量保证topic数量不要过多。如果要支撑大规模topic，需要增加更多的机器资源。

# 时效性

ActiveMQ：ms级；
RabbitMQ：微妙级，这是Rabbitmq的一大特点，延迟是最低的；
RocketMQ:ms级；
Kafka:在ms级内。

# 可用性

ActiveMQ：高，基于主从架构实现高可用性；
RabbitMQ：高，基于主从架构实现高可用性；
RocketMQ:非常高，分布式架构；
Kafka:非常高，Kafka是分布式的，一个数据多个副本，少数机器宕机，不会丢失数据，不会导致不可用。

# 消息可靠性

ActiveMQ：有较低的概率丢失数据；
RabbitMQ：
RocketMQ:参数经过优化配置，可以做到0丢失；
Kafka:参数经过优化配置，可以做到0丢失；

# 功能支持

ActiveMQ：MQ领域的功能及其完备；
RabbitMQ：基于erlang语言开发，并发性能极其好，延时很低；
RocketMQ:MQ功能较为完善，还是分布式的，扩展性能好；
Kafka:功能较为简单，主要支持简单的MQ功能，在大数据领域的实时计算以及日志采集被大规模使用，是事实上的标准；

# 总结

## ActiveMQ

- 非常成熟，功能强大，在业内大量的公司以及项目都有应用；
- 偶尔会有较低概率丢失消息；
- 现在社区以及国内应用都越来越少，官方社区现在对ActiveMQ5.x维护越来越少，几个月才发布一个版本；
- 确实主要是基于解耦和异步来用的，较少在大规模吞吐的场景中使用。

## RabbitMQ

- erlang语言开发的，性能极其好，延时很低；
- 吞吐量到万级，MQ功能比较完备；
- 开源提供管理界面非常棒，用起来很好用；
- 社区很活跃，几乎每个月发布几个版本；
- 国内一些互联网公司近几年用RabbitMQ比较多一些；
- 问题是RabbitMQ的吞吐量也会低一些，这是应为它做的实现机制比较重；
- 而且erlang开发，国内有几个公司有实力做erlang源码级别的研究和定制？如果说你没这个实力的话，确实偶尔会有一些问题，很难去看懂源码，公司对这个东西的掌控很弱，基本只能依赖于开源社区的快速维护和修复bug；
- 而且Rabbitmq集群动态扩展会很麻烦，不过这个我觉得还好。其实主要是erlang语言本身带来的问题。很难读源码，很难定制和掌控。

## RocketMQ

- 接口简单易用，而且毕竟在阿里大规模应用过，有阿里品牌保障；
- 日处理消息上百亿之多，可以做到大规模吞吐，性能也非常好，分布式扩展也很方便，社区维护还可以，可靠性和可用性都是ok的，还可以支撑大规模的topic数量，支持复杂MQ业务场景；
- 而且一个很大的优势在于，阿里出品都是java系的，我们可以自己阅读源码，定制自己公司的MQ，可以掌控；
- 社区活跃度相对较为一般，不过也还可以，文档相对来说简单一些，然后接口这块不是按照标准JMS规范走的有些系统要迁移需要修改大量代码；
- 还有就是阿里出台的技术，你得做好这个技术万一被抛弃，社区黄掉的风险，那如果你们公司有技术实力我觉得用RocketMQ挺好的；

## Kafka

- kafka的特点其实很明显，就是仅仅提供较少的核心功能，但是提供超高的吞吐量，ms级的延迟，极高的可用性以及可靠性，而且分布式可以任意扩展；
- 同时kafka最好是支撑较少的topic数量即可，保证其超高吞吐量；
- 而且kafka唯一的一点劣势是有可能消息重复消费，那么对数据准确性会造成极其轻微的影响，在大数据领域中以及日志采集中，这点轻微影响可以忽略；
- 这个特性天然适合大数据实时计算以及日志收集。