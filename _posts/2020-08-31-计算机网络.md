---
layout: post
title:  "计算机网络"
date:   2020-08-31 14:58:06 +0800--
categories: [计算机网络]
tags: [计算机网络, ]  

---

# 计算机网络概述

> 书籍：计算机网络自顶向下. TCP/IP详解

## 计算机网络的类别

![image-20200921222257485](/assets/imgs/image-20200921222257485.png)

## 计算机网络的性能

- 速率

  连接在计算机网络上的主机在数字信道上传送数据位数的速率，也称data rate或bit rate(比特率)，单位是b/s, kb/s, Mb/s, Gb/s。和正常理解的网速的关系是除以8.

- 带宽

  数据通信领域中，数字信道所能传送的最高数据率，单位是b/s, kb/s, Mb/s, Gb/s。常见的是Mpbs。

- 吞吐量

  在单位时间内通过某个网络的数据量，单位是b/s, Mb/s。

- 时延

  包括发送时延，传播时延，处理时延，排队时延。***发送时延等于数据块长度(bit)除以信道带宽(bit/s)***. 更快的发送速度意味着波长越短，链路上的数据量更大；更快的传播速度意味着在网线中更快的传播速度。

- 时延X带宽(时延带宽积)

  有多少数据正在线路上。

- 往返时间(RTT, Round-Trip Time)

  从发送方发送数据开始，到发送方收到接收方确认数据的时间。例如ping一下。

- 利用率

  ***包括信道利用率***：有数据通过的时间/(有+无)数据通过的时间
  ***网络利用率***：信道利用率的加权平均
  ***网络当前时延D*** = 网络空闲时时延$D_0$ / (1 - 信道利用率U)

## 计算机网络体系结构

### 基本概念

![image-20200921224123486](/assets/imgs/image-20200921224123486.png)

### OSI参考模型

> 分层的意义：标准化，降低各层之间的关联

- 应用层

  所有能产生网络流量的程序

- 表示层

  在传输之前是否进行加密 或 压缩 处理，二进制或ASCII码表示

- 会话层

  看需求端和网站之间的连接；查木马(netstat -nb)

- 传输层

  ***可靠传输，流量控制，不可靠传输***(一个数据包即可，不需要建立会话，例如向DNS查询网站IP地址)

- 网络层

  ***负责选择最佳路径，IP地址编址***(ipv4和ipv6变化只会影响网络层)

- 数据链路层

  数据如何封装(帧的开始和结束，还有透明传输，差错校验(纠错由传输层解决) 添加物理层地址 计算机网卡(MAC) 

- 物理层

  定义网络设备接口标准，电气标准(电压)，如何在物理链路上传输的更快

![image-20200921222040702](/assets/imgs/image-20200921222040702.png)





# 数据链路层

## 以太网帧的格式

在网络层，给数据包增加了接收端和发送端的IP地址。在数据链路层里，增加了帧头帧尾，MAC地址和校验值。

![image-20200922183812721](/assets/imgs/image-20200922183812721.png)

## 数据链路层的三个基本问题

### 封装成帧(framing)

- 封装成帧(framing)就是在一段数据的前后分别 添加首部和尾部，然后就构成了一个帧。确定帧的界限。
- 首部和尾部的一个重要作用就是进行帧定界
- 最大传送单元（Maximum Transfer Unit，MTU）。意思是IP数据报的最大长度（不包括帧头帧尾）。MTU的单位是字节。

![image-20200922184411594](/assets/imgs/image-20200922184411594.png)



### 透明传输

![image-20200922184441856](/Users/silince/Pictures/Typora/image-20200922184441856-0771614.png)

解决办法：

- 发送端的数据链路层在数据中出现控制字符“SOH”或“EOT”的前面插入一个转义字符 “ESC”(其十六进制编码是 1B)。
- ***字节填充***(byte stuffing)或***字符填充***(character stuffing)——接收端的数据链路层在将数据送往网络层之前删除插入的***转义字符***。
- 如果转义字符也出现数据当中，那么应在转义字 符前面插入一个转义字符。当接收端收到连续的 两个转义字符时，就删除其中前面的一个。

![image-20200922185151784](/assets/imgs/image-20200922185151784.png)

### 差错检测

- 在传输过程中可能会产生***比特差错***:1 可能会变成0而0也可能变成1。
- 在一段时间内，传输错误的比特占所传输比特总数的比率称为***误码率 BER (Bit Error Rate)。***
- 误码率与信噪比有很大的关系。
- 为了保证数据传输的可靠性，在计算机网络传 输数据时，必须采用各种差错检测措施。

解决办法：

[***循环冗余检验 CRC 的检错技术***](https://blog.csdn.net/D_leo/article/details/73572373?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.channel_param)

- 仅用循环冗余检验 CRC 差错检测技术只能做到无差错接受(accept)
- “无差错接受”是指:“凡是接受的帧(即不包括丢弃的帧)，我们都能以非常接近于 1 的概率认为这些帧在传输过程中没有产生差错”
- 要做到“***可靠传输***”(即发送什么就收到什么) 就必须再加上***确认和重传机制***。

## 两种情况下的数据链路层

### 使用点对点信道的数据链路层

#### [PPP协议](https://blog.csdn.net/u011857683/article/details/84703473)

ppp协议(point to point protocol)是数据链路层协议，例如用户使用拨号上网。

### 使用广播信道的数据链路层

局域网最主要的特点是:网络为一个单位所拥有，且地理范围和站点数目均有限。

局域网具有如下的一些主要优点:

- ***具有广播功能***，从一个站点可很方便地访问全网。局域网上的主机可共享连接在局域网上的各种硬件 和软件资源。
- 便于系统的扩展和逐渐地演变，各设备的位置可灵活调整和改变。 
- 提高了系统的可靠性、可用性和残存性。

- 局域网的拓扑：

![image-20200922200318043](/assets/imgs/image-20200922200318043.png)



#### CSMA/CD 协议

- CSMA/CD 表示 Carrier Sense Multiple Access with Collision Detection。
-  ***“多点接入”表示许多计算机以多点接入的方式连接在一根总线上。***
- “载波监听”是指每一个站在发送数据之前先 要检测一下总线上是否有其他计算机在发送数 据，如果有，则暂时不要发送数据，以免发生 碰撞。
- 总线上并没有什么“载波”。因此，“载波监 听”就是用电子技术检测总线上有没有其他计算机发送的数据信号。
- 使用 CSMA/CD 协议的以太网不能进行全 双工通信而只能进行双向交替通信(半双工通信)。

![image-20200922202626188](/assets/imgs/image-20200922202626188.png)

***争用期:***

最先发送数据帧的站，在发送数据帧后至 多经过时间 2t (两倍的端到端往返时延) 就可知道发送的数据帧是否遭受了碰撞。以太网的端到端往返时延 2t 称为争用期， 或碰撞窗口。***经过争用期这段时间还没有检测到碰撞， 才能肯定这次发送不会发生碰撞。***

- 争用期的长度
  - 以太网取 51.2 μs 为争用期的长度。
  - 对于 10 Mb/s 以太网，在争用期内可发送 512 bit，即 64 字节。
  - ***以太网在发送数据时，若前 64 字节没有发 生冲突，则后续的数据就不会发生冲突。***
- 最短有效帧长
  - ***如果发生冲突，就一定是在发送的前 64 字节之内。***
  - 由于一检测到冲突就立即中止发送，这时 已经发送出去的数据一定小于 64 字节。
  - 以太网规定了最短有效帧长为 64 字节，凡长度小于 64 字节的帧都是由于冲突而异常中止的***无效帧***。

- ***二进制指数类型退避算法***
  - 发生碰撞的站在停止发送数据后，要推迟 (退避)一个随机时间才能再发送数据。

- 强化碰撞；当发送数据的站一旦发现发生了碰撞时:
  - 立即停止发送数据;
  - 再继续发送若干比特的***人为干扰信号(jamming signal)***，以便让所有用户都知道现在已经发生 了碰撞。

## 以太网

### 星型拓扑结构

![image-20200922203652776](/assets/imgs/image-20200922203652776.png)

以太网与数据链路层的2个子层

为了使数据链路层更好的适应多种局域网标准，802委员会把局域网拆分为：

- 逻辑链路控制LLC(Logical Link Control)子层；
- 媒体接入控制MAC(Medium Access Control)子层。

与接入到传输媒体有关的内容都放在MAC子层上，而LLC子层与传输媒体无关，不管什么协议的局域网对LLC子层都是透明的；
由于局域网标准一般是DIX Ethernet V2而不是IEEE 802.3，所以802.2标准的LLC子层作用已经不大了，很多厂商适配器没有LLC协议；

### 信道利用率

以太网的信道被占用的情况

- 争用期长度为 2t，即端到端传播时延的两倍。 检测到碰撞后不发送干扰信号。
- 帧长为 *L* (bit)，数据发送速率为 *C* (b/s)，因 而帧的发送时间为$ L/C = T_0 (s)$。
- 一个帧从开始发送，经可能发生的碰撞后，将再重传数次，到发送成功且信道转为空闲(即再经过 时间 t 使得信道上无信号在传播)时为止，是发送 一帧所需的平均时间。

![image-20200922204457062](/assets/imgs/image-20200922204457062.png)

### MAC层

在局域网中，硬件地址又称为物理地址， 或 MAC 地址。802 标准所说的“地址”严格地讲应当是 每一个站的“名字”或标识符。

























---



- ARP/RARP协议 (地址解析和逆地址解析)
  - ARP的报文格式
  - ARP查询原理
  - ARP缓存

- 网络层
  - IP协议
    - 掌握IP首部格式：如16位分片标识、DF不分片标志、MF更多分片标志、13位片偏移、8位生存时间TTL、16位的首部检验和等等。
    - 掌握IP分片
    - 掌握IP选路
  - 掌握ICMP协议
    - 报文格式
    - 报文的两大分类：查询+差错（2种查询报文+5种差错报文）
- 传输层
  - 掌握UDP协议
    - 包括特点+首部各个字段
  - 掌握TCP协议
    - 特点+首部字段+可靠机制
    - TCP连接控制机制：三次握手、四次挥手、同时打开、同时关闭、半关闭
    - TCP流量控制机制：滑动窗口、慢启动、拥塞避免、快速重传、快速恢复
    - TCp超时重传机制：各种定时器
- 应用层
  - 掌握DNS协议
    - 掌握DNS协议的名字空间、DNS指针查询(反向查找或逆向解析)基本原理、DNS缓存
    - 掌握FTP协议：他是网络界的活化石
      - 两条连接：控制连接+数据连接
      - 两种工作模式：PASV + PORT
      - 各种FTP指令和响应码
      - FTP断点续传、匿名FTP
  - 掌握HTTP协议
    - 报问格式：请求报文、响应报文、请求头各种字段、响应头各种字段
    - http状态码
  - 掌握HTTPS协议
    - https的详细握手过程
    - 摘要算法、数字签名、数字证书的原理和过程
- [面试题分享](/Users/silince/Develop/面试相关/计算机网络面试题总结.pdf)



# 

