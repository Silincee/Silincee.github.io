---
layout: post
title:  "部署网站遇到的一些问题汇总"
date:   2020-03-07 14:09:06 +0800--
categories: [部署]
tags: [阿里云, 端口占用, 网站维护, tomcat, centos, JavaWeb ]  
---
## 阿里云服务器无法从外部访问

一、问题

部署后./startup.sh启动tomcat 之后外部访问http://ip:8080/无法访问，关闭防火墙后

```
firewall-cmd --state  #查看防火墙状态
systemctl stop firewalld.service #停止firewall
```

再次访问http://ip:8080/还是失败。



二、解决方法

进入阿里云主机控制台，安全组，如下图所示，点击配置规则

![img](/assets/imgs/418191-20170608114222840-1993206155.png)

配置规则，添加规则允许任何IP访问8088，如下图所示

![img](/assets/imgs/418191-20170608114322184-684071749.png)

再次访问http://ip:8088/（因为tomcat的端口我修改成了8088），如下图所示，访问OK

![image-20200307140705984](/assets/imgs/image-20200307140705984.png)



## tomcat修改8080端口

一、背景
在默认情况下，tomcat的端口是8080，使用了两个tomcat，那么就需要修改其中的一个的端口号才能使得两个同时工作。

二、方法
2.1 改动一
那么，如何修改tomcat的端口号呢？首先到安装目录(或者解压目录)下找到conf文件夹，在里面找到server.xml的文件，

找到 

```
<Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443" />
```


将port="8080"改为其它的就可以了。

![image-20200303170053674](/assets/imgs/image-20200303170053674.png)

这种修改对于8080端口冲突是可以解决的，但是如果想同时使用两个tomcat，那么这样的修改还不完整，因为还有其它的端口会冲突。我们仍需要继续修改

2.2 改动二
将 

```
<Connector port="8009" protocol="AJP/1.3" redirectPort="8443" />
```

的8009改为其它。

![image-20200303170114097](/assets/imgs/image-20200303170114097.png)

2.3 改动三
继续将

```
<Server port="8005" shutdown="SHUTDOWN">
```

的8005改为其它。

![image-20200303170129109](/assets/imgs/image-20200303170129109.png)


3、结果
打开浏览器，输入http://192.168.71.128:9999,发现9999端口可以正常访问到tomcat，到此已经成功修改了tomcat的默认8080端口。

经过以上3个修改，应该可以了。如果还不行，那么就看一些错误提示吧，应该会说在那个端口有冲突的，到时再根据需要改动即可。



## centos 搭建JavaWeb环境

