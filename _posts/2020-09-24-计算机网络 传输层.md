---
layout: post
title:  "计算机网络 传输层"
date:   2020-09-24 12:38:06 +0800--
categories: [计算机网络]
tags: [计算机网络, ]  

---

# 运输层协议概述

从通信和信息处理的角度看，运输层向 它上面的应用层提供通信服务，它属于 面向通信部分的最高层，同时也是用户 功能中的最低层。

当网络的边缘部分中的两个主机使用网络的核心部分的功能进行端到端的通信时，只有位于网络边缘部分的主机的协议栈才有运输层，而网络核心部分中的路由器在转发分组时都只用到下三层的功能。

***运输层为相互通信的应用进程提供了逻辑通信。***

![image-20200924193156923](/Users/silince/Develop/博客/blog_to_git/assets/imgs/image-20200924193156923.png)

## 应用进程之间的通信

- 两个主机进行通信实际上就是两个主机中的***应用进程互相通信***。
- 应用进程之间的通信又称为***端到端的通信***。
- 运输层的一个很重要的功能就是***复用和分用***。 应用层不同进程的报文通过不同的端口向下交到运输层，再往下就共用网络层提供的服务。
- “***运输层提供应用进程间的逻辑通信***”。“逻辑通信”的意思是:运输层之间的通信好像是沿水平方向传送数据。但事实上这两个运输层 之间并没有一条水平方向的物理连接。



## 运输层的主要功能

- ***运输层为应用进程之间提供端到端的逻辑通信(但网络层是为主机之间提供逻辑通信)。*** 
- 运输层还要对收到的报文进行差错检测。
- 运输层需要有两种不同的运输协议，即面向连 接的 TCP 和无连接的 UDP。



## 两种不同的运输协议

运输层向高层用户屏蔽了下面网络核心的细节 (如网络拓扑、所采用的路由选择协议等)，它使应用进程看见的就是好像在两个运输层实体之间有一条端到端的逻辑通信信道。

- 当运输层采用面向连接的 TCP 协议时，***尽管下面的网络是不可靠的(只提供尽最大努力服务)，但这种逻辑通信信道就相当于一条全双工的可靠信道。***
- 当运输层采用无连接的 UDP 协议时，这种逻辑通信信道是一条***不可靠信道***。



# TCP 与 UDP

- 两个对等运输实体在通信时传送的数据单位叫作运输协议数据单元 TPDU (Transport Protocol Data Unit)。
- TCP 传送的数据单位协议是 TCP 报文段 (segment)
- UDP传送的数据单位协议是UDP报文或用户数据报。
- ***UDP 在传送数据之前不需要先建立连接***。对 方的运输层在收到 UDP 报文后，不需要给出 任何确认。虽然 UDP 不提供可靠交付，但在 某些情况下 UDP 是一种最有效的工作方式。
- ***TCP 则提供面向连接的服务***。TCP 不提供广 播或多播服务。由于 TCP 要提供可靠的、面 向连接的运输服务，因此不可避免地增加了许 多的开销。这不仅使协议数据单元的首部增大 很多，还要占用许多的处理机资源。

![image-20200924194540778](/Users/silince/Develop/博客/blog_to_git/assets/imgs/image-20200924194540778.png)

⚠️还要强调两点：

- 运输层的 UDP用户数据报与网际层的IP数据报有很大区别。***IP 数据报要经过互连网中许多路由器的存储转发，但 UDP 用户数据报是在运输层的端到端抽象的逻辑信道中传送的***。
- TCP 报文段是在运输层抽象的端到端逻辑信道中传送，这种信道是可靠的全双工信道。***但这样的信道却不知道究竟经过了哪些路由器，而这些路由器也根本不知道上面的运输层是否建立了 TCP 连接。***

## 应用场景

TCP：分段 编号 流量控制 建立会话 `netstat -n`

UDP：不编号(一个数据包即可完成数据通信)  不建立会话  多播 